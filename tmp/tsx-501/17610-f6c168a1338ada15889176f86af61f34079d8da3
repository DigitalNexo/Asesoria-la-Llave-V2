{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import crypto from\"crypto\";const ALGORITHM=\"aes-256-gcm\";const IV_LENGTH=16;const SALT_LENGTH=64;const TAG_LENGTH=16;const KEY_LENGTH=32;let cachedEncryptionKey=null;const getEncryptionKey=__name(()=>{if(cachedEncryptionKey){return cachedEncryptionKey}const key=process.env.ENCRYPTION_KEY;if(!key){console.warn(\"\\u26A0\\uFE0F  ENCRYPTION_KEY no configurada, usando clave determin\\xEDstica temporal (NO seguro para producci\\xF3n)\");cachedEncryptionKey=crypto.pbkdf2Sync(\"dev-fallback-key-not-secure\",\"smtp-salt-fixed\",1e5,KEY_LENGTH,\"sha256\")}else{cachedEncryptionKey=crypto.pbkdf2Sync(key,\"smtp-salt\",1e5,KEY_LENGTH,\"sha256\")}return cachedEncryptionKey},\"getEncryptionKey\");function encryptPassword(password){const iv=crypto.randomBytes(IV_LENGTH);const key=getEncryptionKey();const cipher=crypto.createCipheriv(ALGORITHM,key,iv);let encrypted=cipher.update(password,\"utf8\",\"hex\");encrypted+=cipher.final(\"hex\");const authTag=cipher.getAuthTag();return iv.toString(\"hex\")+authTag.toString(\"hex\")+encrypted}__name(encryptPassword,\"encryptPassword\");function decryptPassword(encryptedPassword){try{const iv=Buffer.from(encryptedPassword.slice(0,IV_LENGTH*2),\"hex\");const authTag=Buffer.from(encryptedPassword.slice(IV_LENGTH*2,(IV_LENGTH+TAG_LENGTH)*2),\"hex\");const encrypted=encryptedPassword.slice((IV_LENGTH+TAG_LENGTH)*2);const key=getEncryptionKey();const decipher=crypto.createDecipheriv(ALGORITHM,key,iv);decipher.setAuthTag(authTag);let decrypted=decipher.update(encrypted,\"hex\",\"utf8\");decrypted+=decipher.final(\"utf8\");return decrypted}catch(error){console.error(\"Error al desencriptar password SMTP:\",error);throw new Error(\"Error al desencriptar credencial SMTP\")}}__name(decryptPassword,\"decryptPassword\");export{decryptPassword,encryptPassword};\n","warnings":[],"map":{"version":3,"mappings":"kHAAA,OAAO,WAAY,SAEnB,MAAM,UAAY,cAClB,MAAM,UAAY,GAClB,MAAM,YAAc,GACpB,MAAM,WAAa,GACnB,MAAM,WAAa,GAGnB,IAAI,oBAAqC,KAIzC,MAAM,iBAAmB,WAAc,CACrC,GAAI,oBAAqB,CACvB,OAAO,mBACT,CAEA,MAAM,IAAM,QAAQ,IAAI,eACxB,GAAI,CAAC,IAAK,CACR,QAAQ,KAAK,qHAAqG,EAGlH,oBAAsB,OAAO,WAAW,8BAA+B,kBAAmB,IAAQ,WAAY,QAAQ,CACxH,KAAO,CAEL,oBAAsB,OAAO,WAAW,IAAK,YAAa,IAAQ,WAAY,QAAQ,CACxF,CAEA,OAAO,mBACT,EAjByB,oBAmBlB,SAAS,gBAAgB,SAA0B,CACxD,MAAM,GAAK,OAAO,YAAY,SAAS,EACvC,MAAM,IAAM,iBAAiB,EAE7B,MAAM,OAAS,OAAO,eAAe,UAAW,IAAK,EAAE,EAEvD,IAAI,UAAY,OAAO,OAAO,SAAU,OAAQ,KAAK,EACrD,WAAa,OAAO,MAAM,KAAK,EAE/B,MAAM,QAAU,OAAO,WAAW,EAGlC,OAAO,GAAG,SAAS,KAAK,EAAI,QAAQ,SAAS,KAAK,EAAI,SACxD,CAbgB,0CAeT,SAAS,gBAAgB,kBAAmC,CACjE,GAAI,CACF,MAAM,GAAK,OAAO,KAAK,kBAAkB,MAAM,EAAG,UAAY,CAAC,EAAG,KAAK,EACvE,MAAM,QAAU,OAAO,KAAK,kBAAkB,MAAM,UAAY,GAAI,UAAY,YAAc,CAAC,EAAG,KAAK,EACvG,MAAM,UAAY,kBAAkB,OAAO,UAAY,YAAc,CAAC,EAEtE,MAAM,IAAM,iBAAiB,EAE7B,MAAM,SAAW,OAAO,iBAAiB,UAAW,IAAK,EAAE,EAC3D,SAAS,WAAW,OAAO,EAE3B,IAAI,UAAY,SAAS,OAAO,UAAW,MAAO,MAAM,EACxD,WAAa,SAAS,MAAM,MAAM,EAElC,OAAO,SACT,OAAS,MAAO,CACd,QAAQ,MAAM,uCAAwC,KAAK,EAC3D,MAAM,IAAI,MAAM,uCAAuC,CACzD,CACF,CAnBgB","names":[],"ignoreList":[],"sources":["/Users/usuario/Documents/Repositorios/Asesoria-La-Llave/server/crypto-utils.ts"],"sourcesContent":[null]}}