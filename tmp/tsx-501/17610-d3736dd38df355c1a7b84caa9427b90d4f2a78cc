{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});let io=null;function setSocketIO(socketIO){io=socketIO}__name(setSocketIO,\"setSocketIO\");function getSocketIO(){return io}__name(getSocketIO,\"getSocketIO\");function notifyUser(userId,notification){if(!io){console.warn(\"Socket.IO no est\\xE1 inicializado\");return}io.to(`user:${userId}`).emit(\"notification\",{...notification,timestamp:new Date().toISOString()})}__name(notifyUser,\"notifyUser\");function notifyRole(role,notification){if(!io){console.warn(\"Socket.IO no est\\xE1 inicializado\");return}io.to(`role:${role}`).emit(\"notification\",{...notification,timestamp:new Date().toISOString()})}__name(notifyRole,\"notifyRole\");function notifyAll(notification){if(!io){console.warn(\"Socket.IO no est\\xE1 inicializado\");return}io.emit(\"notification\",{...notification,timestamp:new Date().toISOString()})}__name(notifyAll,\"notifyAll\");function emitSystemLog(log){if(!io){console.warn(\"Socket.IO no est\\xE1 inicializado\");return}io.emit(\"system:log\",{...log,timestamp:new Date().toISOString()});console.log(`[SYSTEM ${log.type.toUpperCase()}] ${log.message}${log.details?` - ${log.details}`:\"\"}`)}__name(emitSystemLog,\"emitSystemLog\");function notifyTaskChange(action,task,userId){const notification={type:\"task\",action,title:`Tarea ${action===\"created\"?\"creada\":action===\"updated\"?\"actualizada\":\"eliminada\"}`,message:`La tarea \"${task.titulo}\" ha sido ${action===\"created\"?\"creada\":action===\"updated\"?\"actualizada\":\"eliminada\"}`,data:task};if(userId){notifyUser(userId,notification)}else if(task.asignadoA){notifyUser(task.asignadoA,notification)}else{notifyAll(notification)}}__name(notifyTaskChange,\"notifyTaskChange\");function notifyTaxChange(action,clientTax,userId){const notification={type:\"tax\",action,title:`Impuesto ${action===\"created\"?\"asignado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,message:`Un impuesto ha sido ${action===\"created\"?\"asignado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,data:clientTax};if(userId){notifyUser(userId,notification)}else{notifyRole(\"ADMIN\",notification);notifyRole(\"GESTOR\",notification)}}__name(notifyTaxChange,\"notifyTaxChange\");function notifyManualChange(action,manual){const notification={type:\"manual\",action,title:`Manual ${action===\"created\"?\"publicado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,message:`El manual \"${manual.titulo}\" ha sido ${action===\"created\"?\"publicado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,data:manual};notifyAll(notification)}__name(notifyManualChange,\"notifyManualChange\");function notifyClientChange(action,client){const notification={type:\"client\",action,title:`Cliente ${action===\"created\"?\"creado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,message:`El cliente \"${client.razonSocial}\" ha sido ${action===\"created\"?\"creado\":action===\"updated\"?\"actualizado\":\"eliminado\"}`,data:client};notifyRole(\"ADMIN\",notification);notifyRole(\"GESTOR\",notification)}__name(notifyClientChange,\"notifyClientChange\");function notifyReminder(type,item,userId){const isTask=type===\"task\";const notification={type,action:\"reminder\",title:`Recordatorio: ${isTask?\"Tarea\":\"Impuesto\"} pr\\xF3ximo a vencer`,message:isTask?`La tarea \"${item.titulo}\" vence el ${new Date(item.fechaVencimiento).toLocaleDateString()}`:`El impuesto vence el ${new Date(item.fechaLimite).toLocaleDateString()}`,data:item};notifyUser(userId,notification)}__name(notifyReminder,\"notifyReminder\");export{emitSystemLog,getSocketIO,notifyAll,notifyClientChange,notifyManualChange,notifyReminder,notifyRole,notifyTaskChange,notifyTaxChange,notifyUser,setSocketIO};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/usuario/Documents/Repositorios/Asesoria-La-Llave/server/websocket.ts"],"sourcesContent":[null]}}