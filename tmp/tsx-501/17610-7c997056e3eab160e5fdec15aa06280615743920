{"code":"var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,\"name\",{value,configurable:true});import{PrismaClient}from\"@prisma/client\";import archiver from\"archiver\";import{createWriteStream,promises as fs}from\"fs\";import{join,dirname}from\"path\";import{fileURLToPath}from\"url\";import{exec}from\"child_process\";import{promisify}from\"util\";import{emitSystemLog}from\"../websocket.js\";const execAsync=promisify(exec);const __filename=fileURLToPath(import.meta.url);const __dirname=dirname(__filename);const prisma=new PrismaClient;function replacePatternVariables(pattern,version){const now=new Date;function getISOWeekNumber(date){const d=new Date(date);d.setHours(0,0,0,0);d.setDate(d.getDate()+4-(d.getDay()||7));const yearStart=new Date(d.getFullYear(),0,1);const weekNo=Math.ceil(((d.getTime()-yearStart.getTime())/864e5+1)/7);return weekNo}__name(getISOWeekNumber,\"getISOWeekNumber\");const weekNumber=getISOWeekNumber(now);function getWeekOfMonth(date){const startOfMonth=new Date(date.getFullYear(),date.getMonth(),1);const startDay=startOfMonth.getDay();const daysToMonday=startDay===0?1:startDay===1?0:8-startDay;const firstMonday=1+daysToMonday;const dayOfMonth=date.getDate();if(dayOfMonth<firstMonday){return 0}return Math.floor((dayOfMonth-firstMonday)/7)+1}__name(getWeekOfMonth,\"getWeekOfMonth\");const weekNumberInMonth=getWeekOfMonth(now);const dayNames=[\"Domingo\",\"Lunes\",\"Martes\",\"Mi\\xE9rcoles\",\"Jueves\",\"Viernes\",\"S\\xE1bado\"];const monthNames=[\"Enero\",\"Febrero\",\"Marzo\",\"Abril\",\"Mayo\",\"Junio\",\"Julio\",\"Agosto\",\"Septiembre\",\"Octubre\",\"Noviembre\",\"Diciembre\"];const variables={\"{fecha}\":now.toISOString().split(\"T\")[0].replace(/-/g,\"\"),\"{hora}\":now.toTimeString().split(\" \")[0].replace(/:/g,\"\"),\"{version}\":version,\"{timestamp}\":Date.now().toString(),\"{YEAR_4}\":now.getFullYear().toString(),\"{YEAR_2}\":now.getFullYear().toString().slice(-2),\"{MONTH_NUMBER}\":String(now.getMonth()+1).padStart(2,\"0\"),\"{MONTH_NAME}\":monthNames[now.getMonth()],\"{MONTH_DAY_NUMBER}\":String(now.getDate()).padStart(2,\"0\"),\"{WEEK_DAY_NUMBER}\":now.getDay().toString(),\"{WEEK_DAY_NAME}\":dayNames[now.getDay()],\"{HOURS}\":String(now.getHours()).padStart(2,\"0\"),\"{MINUTES}\":String(now.getMinutes()).padStart(2,\"0\"),\"{SECONDS}\":String(now.getSeconds()).padStart(2,\"0\"),\"{WEEK_NUMBER}\":String(weekNumber).padStart(2,\"0\"),\"{WEEK_NUMBER_IN_THE_MONTH}\":weekNumberInMonth.toString()};let result=pattern;Object.entries(variables).forEach(([key,value])=>{result=result.replaceAll(key,value)});return result}__name(replacePatternVariables,\"replacePatternVariables\");async function createDatabaseBackup(fileName){const backupDir=join(__dirname,\"../../backups/db\");await fs.mkdir(backupDir,{recursive:true});const filePath=join(backupDir,fileName);const dbUrl=process.env.DATABASE_URL;if(!dbUrl){throw new Error(\"DATABASE_URL no est\\xE1 definida\")}try{const match=dbUrl.match(/mysql:\\/\\/([^:]+):([^@]+)@([^:]+):(\\d+)\\/(.+)/);if(!match){throw new Error(\"Formato de DATABASE_URL no v\\xE1lido\")}const[,user,password,host,port,database]=match;const command=`mysqldump -h ${host} -P ${port} -u ${user} -p${password} ${database} > ${filePath}`;try{await execAsync(command);console.log(\"\\u2705 Backup de BD creado con mysqldump\")}catch(error){console.log(\"\\u26A0\\uFE0F mysqldump no disponible, usando m\\xE9todo alternativo\");await createDatabaseBackupFallback(filePath)}const stats=await fs.stat(filePath);return{path:filePath,size:BigInt(stats.size)}}catch(error){console.error(\"Error creando backup de BD:\",error);throw error}}__name(createDatabaseBackup,\"createDatabaseBackup\");async function createDatabaseBackupFallback(filePath){let sqlContent=`-- Backup creado el ${new Date().toISOString()}\n`;sqlContent+=`-- Generado con Prisma (fallback sin mysqldump)\n\n`;try{const tables=[{tableName:\"users\",model:prisma.user},{tableName:\"roles\",model:prisma.role},{tableName:\"permissions\",model:prisma.permission},{tableName:\"role_permissions\",model:prisma.rolePermission},{tableName:\"clients\",model:prisma.client},{tableName:\"client_employees\",model:prisma.clientEmployee},{tableName:\"tax_models\",model:prisma.taxModel},{tableName:\"tax_periods\",model:prisma.taxPeriod},{tableName:\"client_tax\",model:prisma.clientTax},{tableName:\"tax_files\",model:prisma.taxFile},{tableName:\"tasks\",model:prisma.task},{tableName:\"manuals\",model:prisma.manual},{tableName:\"manual_attachments\",model:prisma.manualAttachment},{tableName:\"manual_versions\",model:prisma.manualVersion},{tableName:\"activity_logs\",model:prisma.activityLog},{tableName:\"audit_trail\",model:prisma.auditTrail},{tableName:\"smtp_config\",model:prisma.smtpConfig},{tableName:\"client_tax_requirements\",model:prisma.clientTaxRequirement},{tableName:\"fiscal_periods\",model:prisma.fiscalPeriod},{tableName:\"client_tax_filings\",model:prisma.clientTaxFiling},{tableName:\"job_runs\",model:prisma.jobRun},{tableName:\"system_settings\",model:prisma.systemSettings},{tableName:\"smtp_accounts\",model:prisma.sMTPAccount},{tableName:\"notification_templates\",model:prisma.notificationTemplate},{tableName:\"notification_logs\",model:prisma.notificationLog},{tableName:\"scheduled_notifications\",model:prisma.scheduledNotification},{tableName:\"system_config\",model:prisma.systemConfig},{tableName:\"system_backups\",model:prisma.systemBackup},{tableName:\"storage_configs\",model:prisma.storageConfig}];for(const table of tables){const records=await table.model.findMany();if(records.length>0){sqlContent+=`-- Tabla ${table.tableName}\n`;for(const record of records){const columns=Object.keys(record);const values=columns.map(col=>{const val=record[col];if(val===null)return\"NULL\";if(typeof val===\"string\")return`'${val.replace(/'/g,\"''\")}'`;if(val instanceof Date)return`'${val.toISOString()}'`;if(typeof val===\"boolean\")return val?\"1\":\"0\";if(typeof val===\"bigint\")return val.toString();if(typeof val===\"object\")return`'${JSON.stringify(val).replace(/'/g,\"''\")}'`;return val});sqlContent+=`INSERT INTO ${table.tableName} (${columns.join(\", \")}) VALUES (${values.join(\", \")});\n`}sqlContent+=\"\\n\"}}await fs.writeFile(filePath,sqlContent,\"utf-8\");console.log(\"\\u2705 Backup de BD creado con Prisma (m\\xE9todo alternativo funcional)\")}catch(error){console.error(\"Error en backup alternativo:\",error);throw error}}__name(createDatabaseBackupFallback,\"createDatabaseBackupFallback\");async function createFilesBackup(fileName){const backupDir=join(__dirname,\"../../backups/files\");await fs.mkdir(backupDir,{recursive:true});const filePath=join(backupDir,fileName);return new Promise((resolve,reject)=>{const output=createWriteStream(filePath);const archive=archiver(\"zip\",{zlib:{level:9}});output.on(\"close\",async()=>{const stats=await fs.stat(filePath);resolve({path:filePath,size:BigInt(stats.size)})});archive.on(\"error\",err=>{reject(err)});archive.pipe(output);const rootDir=join(__dirname,\"../..\");archive.glob(\"**/*\",{cwd:rootDir,ignore:[\"node_modules/**\",\".git/**\",\"backups/**\",\"dist/**\",\".env.local\",\"*.log\"]});try{archive.file(join(rootDir,\".env\"),{name:\".env\"})}catch(error){console.warn(\"No se pudo agregar .env al backup\")}try{archive.directory(join(rootDir,\"uploads\"),\"uploads\")}catch(error){console.warn(\"No se pudo agregar carpeta uploads al backup\")}archive.finalize()})}__name(createFilesBackup,\"createFilesBackup\");async function createSystemBackup(userId){let backupId=null;try{emitSystemLog({type:\"backup\",level:\"info\",message:\"Iniciando creaci\\xF3n de backup del sistema...\"});const packageJsonPath=join(__dirname,\"../../package.json\");const packageJson=await fs.readFile(packageJsonPath,\"utf-8\");const pkg=JSON.parse(packageJson);const version=pkg.version||\"1.0.0\";const dbPatternConfig=await prisma.systemConfig.findUnique({where:{key:\"backup_db_pattern\"}});const filesPatternConfig=await prisma.systemConfig.findUnique({where:{key:\"backup_files_pattern\"}});const dbPattern=dbPatternConfig?.value||\"backup_db_{fecha}_{hora}.sql\";const filesPattern=filesPatternConfig?.value||\"backup_files_{fecha}_{hora}.zip\";const dbFileName=replacePatternVariables(dbPattern,version);const filesFileName=replacePatternVariables(filesPattern,version);const backup=await prisma.systemBackup.create({data:{version,dbFile:dbFileName,filesFile:filesFileName,status:\"CREATING\",createdBy:userId}});backupId=backup.id;emitSystemLog({type:\"backup\",level:\"info\",message:\"Backup registrado en base de datos\",details:`ID: ${backup.id}, Versi\\xF3n: ${version}`});emitSystemLog({type:\"backup\",level:\"info\",message:\"Creando backup de base de datos...\",details:dbFileName});const dbBackup=await createDatabaseBackup(dbFileName);emitSystemLog({type:\"backup\",level:\"success\",message:\"Backup de base de datos completado\"});emitSystemLog({type:\"backup\",level:\"info\",message:\"Creando backup de archivos...\",details:filesFileName});const filesBackup=await createFilesBackup(filesFileName);emitSystemLog({type:\"backup\",level:\"success\",message:\"Backup de archivos completado\"});await prisma.systemBackup.update({where:{id:backup.id},data:{status:\"COMPLETED\",dbSize:dbBackup.size,filesSize:filesBackup.size,completedAt:new Date}});emitSystemLog({type:\"backup\",level:\"success\",message:\"Backup completado exitosamente\"});return{id:backup.id,dbFile:dbFileName,filesFile:filesFileName,dbSize:dbBackup.size,filesSize:filesBackup.size,version}}catch(error){const errorMessage=error instanceof Error?error.message:\"Error desconocido\";emitSystemLog({type:\"backup\",level:\"error\",message:\"Error al crear backup\",details:errorMessage});if(backupId){await prisma.systemBackup.update({where:{id:backupId},data:{status:\"FAILED\",errorMessage,completedAt:new Date}})}throw error}}__name(createSystemBackup,\"createSystemBackup\");async function listBackups(){return await prisma.systemBackup.findMany({orderBy:{createdAt:\"desc\"},include:{creator:{select:{id:true,username:true,email:true}}}})}__name(listBackups,\"listBackups\");async function cleanOldBackups(){const retentionConfig=await prisma.systemConfig.findUnique({where:{key:\"backup_retention_days\"}});const retentionDays=parseInt(retentionConfig?.value||\"30\");if(retentionDays===0){return 0}const cutoffDate=new Date;cutoffDate.setDate(cutoffDate.getDate()-retentionDays);const oldBackups=await prisma.systemBackup.findMany({where:{createdAt:{lt:cutoffDate},status:\"COMPLETED\"}});for(const backup of oldBackups){try{const dbPath=join(__dirname,\"../../backups/db\",backup.dbFile);const filesPath=join(__dirname,\"../../backups/files\",backup.filesFile);await fs.unlink(dbPath).catch(()=>{});await fs.unlink(filesPath).catch(()=>{})}catch(error){console.error(`Error eliminando archivos de backup ${backup.id}:`,error)}}const result=await prisma.systemBackup.deleteMany({where:{createdAt:{lt:cutoffDate},status:\"COMPLETED\"}});console.log(`\\u{1F9F9} Eliminados ${result.count} backups antiguos`);return result.count}__name(cleanOldBackups,\"cleanOldBackups\");async function restoreFromBackup(backupId,userId){let backup;try{emitSystemLog({type:\"restore\",level:\"info\",message:\"Iniciando restauraci\\xF3n desde backup...\"});backup=await prisma.systemBackup.findUnique({where:{id:backupId}});if(!backup){throw new Error(\"Backup no encontrado\")}if(backup.status!==\"COMPLETED\"){throw new Error(\"Solo se pueden restaurar backups completados\")}emitSystemLog({type:\"restore\",level:\"info\",message:`Restaurando desde backup creado el ${new Date(backup.createdAt).toLocaleString(\"es-ES\")}`,details:`Versi\\xF3n: ${backup.version}`});await prisma.systemBackup.update({where:{id:backupId},data:{status:\"RESTORING\"}});const dbPath=join(__dirname,\"../../backups/db\",backup.dbFile);const filesPath=join(__dirname,\"../../backups/files\",backup.filesFile);await fs.access(dbPath);await fs.access(filesPath);emitSystemLog({type:\"restore\",level:\"info\",message:\"Descomprimiendo archivos del backup...\"});await extractBackupFiles(filesPath);emitSystemLog({type:\"restore\",level:\"success\",message:\"Archivos descomprimidos correctamente\"});emitSystemLog({type:\"restore\",level:\"info\",message:\"Restaurando base de datos...\"});await restoreDatabase(dbPath);emitSystemLog({type:\"restore\",level:\"success\",message:\"Base de datos restaurada correctamente\"});await prisma.systemBackup.update({where:{id:backupId},data:{status:\"RESTORED\",completedAt:new Date}});emitSystemLog({type:\"restore\",level:\"success\",message:\"Restauraci\\xF3n completada exitosamente\"});emitSystemLog({type:\"restore\",level:\"warning\",message:\"IMPORTANTE: Reinicie el servidor para aplicar los cambios\"})}catch(error){const errorMessage=error instanceof Error?error.message:\"Error desconocido\";emitSystemLog({type:\"restore\",level:\"error\",message:\"Error al restaurar backup\",details:errorMessage});if(backup){await prisma.systemBackup.update({where:{id:backupId},data:{status:\"FAILED\",errorMessage}})}throw error}}__name(restoreFromBackup,\"restoreFromBackup\");async function extractBackupFiles(zipPath){const rootDir=join(__dirname,\"../..\");try{await execAsync(`unzip -o \"${zipPath}\" -d \"${rootDir}\"`);console.log(\"\\u2705 Archivos extra\\xEDdos con unzip\")}catch(error){console.log(\"\\u26A0\\uFE0F unzip no disponible, usando m\\xE9todo alternativo\");console.log(\"\\u26A0\\uFE0F Extracci\\xF3n de archivos requiere unzip en el sistema\")}}__name(extractBackupFiles,\"extractBackupFiles\");async function restoreDatabase(sqlPath){const dbUrl=process.env.DATABASE_URL;if(!dbUrl){throw new Error(\"DATABASE_URL no est\\xE1 definida\")}const match=dbUrl.match(/mysql:\\/\\/([^:]+):([^@]+)@([^:]+):(\\d+)\\/(.+)/);if(!match){throw new Error(\"Formato de DATABASE_URL no v\\xE1lido\")}const[,user,password,host,port,database]=match;try{const command=`mysql -h ${host} -P ${port} -u ${user} -p${password} ${database} < ${sqlPath}`;await execAsync(command);console.log(\"\\u2705 Base de datos restaurada con mysql\")}catch(error){console.error(\"\\u26A0\\uFE0F mysql no disponible para restaurar BD\");console.log(\"\\u26A0\\uFE0F La restauraci\\xF3n de BD requiere mysql client en el sistema\");throw new Error(\"No se pudo restaurar la base de datos: mysql no disponible\")}}__name(restoreDatabase,\"restoreDatabase\");async function restartService(){const platform=process.platform;try{if(platform===\"win32\"){console.log(\"\\u{1F504} Reiniciando servicio en Windows...\");try{await execAsync(\"npm run restart\")}catch{console.log(\"\\u26A0\\uFE0F Use el administrador de servicios de Windows para reiniciar\")}}else{console.log(\"\\u{1F504} Reiniciando servicio en Linux...\");try{await execAsync(\"pm2 restart all\");console.log(\"\\u2705 Servicio reiniciado con pm2\")}catch{try{await execAsync(\"systemctl restart asesoria-app\");console.log(\"\\u2705 Servicio reiniciado con systemctl\")}catch{console.log(\"\\u26A0\\uFE0F Reinicie el servidor manualmente\")}}}}catch(error){console.error(\"Error al reiniciar servicio:\",error);throw error}}__name(restartService,\"restartService\");export{cleanOldBackups,createSystemBackup,listBackups,restartService,restoreFromBackup};\n","warnings":[],"map":{"version":3,"mappings":"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","names":[],"ignoreList":[],"sources":["/Users/usuario/Documents/Repositorios/Asesoria-La-Llave/server/services/backup-service.ts"],"sourcesContent":[null]}}